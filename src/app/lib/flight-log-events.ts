// Flight log events for the habit tracker space journey

export const productiveEvents = [
  "Carburant plein, moteurs à 100%, cap sur la destination !",
  "Navigation optimale détectée, vitesse de croisière atteinte.",
  "Réparations terminées, tous les systèmes sont opérationnels.",
  "Équipage en pleine forme, moral au beau fixe !",
  "Nouvelle technologie installée, efficacité améliorée de 20%.",
  "Astéroïde évité avec brio grâce à une manœuvre habile.",
  "Ravitaillement réussi, réserves au maximum.",
  "Communication établie avec la base, félicitations reçues.",
  "Moteurs recalibrés, propulsion optimale rétablie.",
  "Boucliers renforcés, prêts pour le voyage.",
  "Carte stellaire mise à jour, route dégagée devant nous.",
  "Système de navigation amélioré, temps de trajet réduit.",
  "Rencontre avec un vaisseau ami, échange de provisions.",
  "Découverte d'un raccourci spatial, gain de temps considérable.",
  "Équipe motivée, productivité en hausse !",
  "Maintenance préventive effectuée, tout fonctionne parfaitement.",
  "Formation de l'équipage complétée, compétences renforcées.",
  "Nouveau membre rejoint l'équipage, bienvenue à bord !",
  "Scanners optimisés, détection des dangers améliorée.",
  "Réacteurs nettoyés, puissance maximale retrouvée.",
  "Énergie solaire captée, batteries rechargées à 150%.",
  "Records de vitesse battus, médaille d'honneur décernée.",
  "Nouvelle planète découverte et nommée en notre honneur.",
  "Système d'hibernation perfectionné, repos optimal garanti.",
  "Armure du vaisseau renforcée avec de l'adamantium.",
  "Menu du jour amélioré, moral de l'équipage au top.",
  "Anticorps spatiaux synthétisés, santé +100.",
  "Module de téléportation installé, voyage instantané possible.",
  "Champ de force déployé, invulnérabilité temporaire activée.",
  "Intelligence artificielle améliorée, aide précieuse obtenue.",
  "Économie de 50% de carburant grâce à une nouvelle technique.",
  "Galaxie traversée sans encombre, respect de l'équipage gagné.",
  "Trésor spatial trouvé, finances de la mission assurées.",
  "Alliance formée avec une civilisation avancée.",
  "Comète domptée et utilisée pour accélérer.",
  "Jardin hydroponique florissant, fruits frais pour tous.",
  "Compétition de vitesse remportée haut la main.",
  "Signal extraterrestre décodé, connaissances augmentées.",
  "Anomalie gravitationnelle exploitée pour gagner du temps.",
  "Système de recyclage optimisé, autonomie doublée.",
  "Insigne de bravoure cosmique reçu du commandement.",
  "Passage à travers une nébuleuse sans dommages.",
  "Station spatiale amie rencontrée, repos bien mérité.",
  "Logiciel de pilotage mis à jour, précision maximale.",
  "Chemin balisé découvert, navigation facilitée.",
  "Protection contre les radiations améliorée.",
  "Cristaux énergétiques récoltés, réserves pleines.",
  "Moral au zénith après un discours inspirant du capitaine.",
  "Routine d'exercice terminée, forme physique excellente.",
  "Méditation collective réussie, concentration renforcée.",
];

export const unproductiveEvents = [
  "Impact de météorite, les moteurs nécessitent des réparations.",
  "Journée passée sur une planète-vacances, aucun progrès réalisé.",
  "Panne de réveil cosmique, départ retardé de 12 heures.",
  "Débris spatiaux bloquent la route, déviation nécessaire.",
  "Le capitaine a oublié de remplir le réservoir. Encore.",
  "Partie de poker spatial qui a duré toute la journée.",
  "Tempête solaire détectée, vaisseau en mode veille forcée.",
  "L'équipage a regardé toute la série 'Star Trek' en marathon.",
  "Attraction gravitationnelle imprévue, recalcul de trajectoire.",
  "Pizza party intergalactique, mission reportée.",
  "Sieste prolongée dans la zone de microgravité.",
  "Combat de boules de neige cosmique dans la soute.",
  "Le GPS spatial a encore bugué, on est perdus.",
  "Alien mignon trouvé, journée consacrée aux câlins.",
  "Trou noir repéré, temps ralenti de 90%.",
  "Karaoke spatial jusqu'à 4h du matin, équipage fatigué.",
  "Wifi cosmique coupé, moral en berne.",
  "Les provisions étaient périmées, intoxication alimentaire générale.",
  "Découverte d'une planète de chats, impossible de repartir.",
  "Bug dans le pilote automatique, vol en cercle toute la journée.",
  "Réunion d'équipage qui aurait pu être un email.",
  "Les plantes du vaisseau ont envahi la salle des machines.",
  "Journée portes ouvertes pour touristes de l'espace.",
  "Le robot de bord a fait grève pour de meilleures conditions.",
  "Festival de musique interstellaire, tout le monde y est allé.",
  "Pluie de météorites colorées, trop beau pour travailler.",
  "Le chat du vaisseau a dormi sur le tableau de bord.",
  "Journée dédiée à la contemplation d'une supernova.",
  "Bataille de polochons en apesanteur, cohésion d'équipe.",
  "Le frigo spatial a lâché, journée consacrée aux réparations.",
  "Tournoi de jeux vidéo rétro, tout le monde a participé.",
  "Invasion de space-hamsters dans la salle de contrôle.",
  "Aurores boréales cosmiques, photos obligatoires.",
  "Le navigateur a lu la carte à l'envers, demi-tour nécessaire.",
  "Journée pyjama déclarée par vote démocratique.",
  "Alarme incendie déclenchée par un toast brûlé.",
  "Séance shopping sur une station commerciale orbitale.",
  "Tout le monde a oublié l'anniversaire du vaisseau.",
  "Concours de sculpture de glace dans la chambre froide.",
  "L'IA du bord a décidé de prendre un jour de congé.",
  "Brouillard nébuleux épais, visibilité nulle, pause forcée.",
  "Découverte d'un fast-food flottant, impossible de résister.",
  "Binge-watching de documentaires sur les trous noirs.",
  "L'équipage s'est perdu dans un labyrinthe d'astéroïdes.",
  "Sieste collective après un repas trop copieux.",
  "Fête surprise organisée pour personne en particulier.",
  "Le système de divertissement a planté, crise existentielle.",
  "Journée dédiée à l'observation de planètes lointaines.",
  "Match de football en apesanteur, règles incompréhensibles.",
  "Panne de courant pendant 6 heures, bougies romantiques.",
  "Défi 'ne rien faire pendant 24h' relevé avec succès.",
  "Les cosmonautes ont organisé un spa improvisé.",
  "Tournée des bars spatiaux de la galaxie sud.",
  "Le hamster de compagnie a mangé les câbles importants.",
  "Marathon de films d'horreur, personne n'a dormi après.",
  "Journée lecture de romans de science-fiction ironiques.",
  "L'équipage a appris à jongler en microgravité.",
  "Fête foraine cosmique découverte, manèges obligatoires.",
  "Cours de cuisine spatiale raté, cuisine hors service.",
  "Championnat de fléchettes magnétiques, très compétitif.",
];

export function getFlightLogEvent(date: Date, wasCompleted: boolean): string {
  const events = wasCompleted ? productiveEvents : unproductiveEvents;
  
  // Use date as seed for consistent event per day
  const dateString = date.toISOString().split('T')[0];
  const seed = dateString.split('-').reduce((acc, val) => acc + parseInt(val), 0);
  const index = seed % events.length;
  
  return events[index];
}

export function generateFlightLog(
  startDate: Date,
  completions: string[],
  flightLogEvents: Record<string, string>,
  maxDays: number = 7
): Array<{ date: Date; event: string; completed: boolean }> {
  const log: Array<{ date: Date; event: string; completed: boolean }> = [];
  const today = new Date();
  today.setHours(0, 0, 0, 0);
  const todayString = today.toISOString().split('T')[0];
  
  // Normalize completion dates
  const completionDates = completions.map(c => {
    const d = new Date(c);
    d.setHours(0, 0, 0, 0);
    return d.toISOString().split('T')[0];
  });
  
  // Start from today and go backwards
  for (let i = 0; i < maxDays; i++) {
    const date = new Date(today);
    date.setDate(date.getDate() - i);
    
    // Don't show dates before the goal started
    if (date < startDate) break;
    
    const dateString = date.toISOString().split('T')[0];
    const wasCompleted = completionDates.includes(dateString);
    
    // Skip today if it hasn't been completed yet (don't show negative event)
    if (dateString === todayString && !wasCompleted) continue;
    
    // Use stored event if available, otherwise generate one
    const event = flightLogEvents[dateString] || getFlightLogEvent(date, wasCompleted);
    
    log.push({
      date,
      event,
      completed: wasCompleted,
    });
  }
  
  return log;
}
